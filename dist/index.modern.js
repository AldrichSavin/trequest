import t from"axios";function n(t,n){t.prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n)}function e(t){return e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},e(t)}function r(t,n){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},r(t,n)}function o(t,n,e){return o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct.bind():function(t,n,e){var o=[null];o.push.apply(o,n);var i=new(Function.bind.apply(t,o));return e&&r(i,e.prototype),i},o.apply(null,arguments)}function i(t){var n="function"==typeof Map?new Map:void 0;return i=function(t){if(null===t||-1===Function.toString.call(t).indexOf("[native code]"))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,i)}function i(){return o(t,arguments,e(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),r(i,t)},i(t)}var u="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function c(t,n,e){if(!t.s){if(e instanceof s){if(!e.s)return void(e.o=c.bind(null,t,n));1&n&&(n=e.s),e=e.v}if(e&&e.then)return void e.then(c.bind(null,t,n),c.bind(null,t,2));t.s=n,t.v=e;var r=t.o;r&&r(t)}}var s=/*#__PURE__*/function(){function t(){}return t.prototype.then=function(n,e){var r=new t,o=this.s;if(o){var i=1&o?n:e;if(i){try{c(r,1,i(this.v))}catch(t){c(r,2,t)}return r}return this}return this.o=function(t){try{var o=t.v;1&t.s?c(r,1,n?n(o):o):e?c(r,1,e(o)):c(r,2,o)}catch(t){c(r,2,t)}},r},t}();function f(t){return t instanceof s&&1&t.s}var a=/*#__PURE__*/function(t){function e(n){var e;return void 0===n&&(n={}),(e=t.call(this)||this).coreContext=void 0,e.coreContext=n,e}n(e,t);var r=e.prototype;return r.register=function(t){var n=this;(Array.isArray(t)?t:[t]).forEach(function(t){n.add(t),null==t.onRegister||t.onRegister(n.coreContext)})},r.initPluginContext=function(t,n){(Array.isArray(t)?t:[t]).forEach(function(t){null==t.setContext||t.setContext(n)}),this.run("onInit")},r.unregister=function(t){this.delete(t)},r.filters=function(t){return Array.from(this).map(function(n){if(n[t]&&"function"==typeof n[t])return n[t].bind(n)}).filter(Boolean)},r.run=function(t){var n=arguments;this.filters(t).forEach(function(t){t.apply(t,[].slice.call(n,1))})},r.runAsync=function(t){var n=arguments,e=this.filters(t);return Promise.all(e.map(function(t){return t.apply(t,[].slice.call(n,1))}))},r.runSync=function(t){try{var n=arguments,e=function(t,n,e){if("function"==typeof t[u]){var r,o,i,a=t[u]();if(function t(e){try{for(;!(r=a.next()).done;)if((e=n(r.value))&&e.then){if(!f(e))return void e.then(t,i||(i=c.bind(null,o=new s,2)));e=e.v}o?c(o,1,e):o=e}catch(t){c(o||(o=new s),2,t)}}(),a.return){var l=function(t){try{r.done||a.return()}catch(t){}return t};if(o&&o.then)return o.then(l,function(t){throw l(t)});l()}return o}if(!("length"in t))throw new TypeError("Object is not iterable");for(var h=[],p=0;p<t.length;p++)h.push(t[p]);return function(t,n,e){var r,o,i=-1;return function e(u){try{for(;++i<t.length;)if((u=n(i))&&u.then){if(!f(u))return void u.then(e,o||(o=c.bind(null,r=new s,2)));u=u.v}r?c(r,1,u):r=u}catch(t){c(r||(r=new s),2,t)}}(),r}(h,function(t){return n(h[t])})}(this.filters(t),function(t){return Promise.resolve(t.apply(t,[].slice.call(n,1))).then(function(){})});return Promise.resolve(e&&e.then?e.then(function(){}):void 0)}catch(t){return Promise.reject(t)}},r.runOnion=function(t){var n=arguments;return this.filters(t).reduce(function(t,e){var r;return null!=(r=e.apply(e,[].slice.call(n,1)))?r:t},void 0)},r.runOnionAsync=function(t){return this.filters(t).reduce(function(t,n){try{var e=arguments;return Promise.resolve(t).then(function(t){var r;return null!=(r=n.apply(n,[].slice.call(e,1)))?r:t})}catch(t){return Promise.reject(t)}},Promise.resolve(void 0))},r.getPluginByName=function(t){return Array.from(this).find(function(n){return n.name===t})},e}(/*#__PURE__*/i(Set)),l=function(t){return"[object Object]"===Object.prototype.toString.call(t)},h=/*#__PURE__*/function(e){function r(n){var r;return void 0===n&&(n={}),(r=e.call(this)||this).coreConfig=void 0,r.instance=void 0,r.coreConfig=n,r.mountPlugins(),r.instance=t.create({}),r.registerRequestInterceptor(),r.registerResponseInterceptor(),r}n(r,e);var o=r.prototype;return o.mountPlugins=function(){var t=this.coreConfig.plugins,n=void 0===t?[]:t;this.register(n),this.initPluginContext(n,this)},o.registerRequestInterceptor=function(){var t=this,n=this;this.instance.interceptors.request.use(function(n){try{return t.run("onRequest",n),Promise.resolve(n)}catch(t){return Promise.reject(t)}},function(t){try{return Promise.resolve(n.runOnionAsync("onError",t)).then(function(e){return n.run("onFinally",e||t),Promise.reject(e||t)})}catch(t){return Promise.reject(t)}})},o.registerResponseInterceptor=function(){var t=this,n=this;this.instance.interceptors.response.use(function(n){try{return Promise.resolve(t.runOnionAsync("onResponse",n)).then(function(e){var r=e||n.data;return t.run("onFinally",r),r})}catch(t){return Promise.reject(t)}},function(t){try{return Promise.resolve(n.runOnionAsync("onError",t)).then(function(e){return n.run("onFinally",t),Promise.reject(e||t)})}catch(t){return Promise.reject(t)}})},o.isProtocol=function(t){return/(http|https|ws|wss):\/\/([\w.]+\/?)\S*/.test(t)},o.getBaseURL=function(t){var n,e;return t?this.isProtocol(t)?t:l(this.coreConfig.baseURL)&&(null==(e=this.coreConfig.baseURL)?void 0:e[t])||t:"string"==typeof this.coreConfig.baseURL?this.coreConfig.baseURL:l(this.coreConfig.baseURL)&&Reflect.has(this.coreConfig.baseURL||{},"default")?Reflect.get(this.coreConfig.baseURL||{},"default"):(null==(n=this.instance)||null==(n=n.defaults)?void 0:n.baseURL)||""},o.request=function(t){var n;if(null==(n=this.instance)||!n.request)throw new Error("HttpCore instance is not initialized");return this.runOnionAsync("onBeforeRequest",t),this.instance.request(this.mergeConfig(t,{baseURL:this.getBaseURL(t.baseURL)}))},o.mergeConfig=function(t,n){return Object.assign({},t,n)},r}(a),p=/*#__PURE__*/function(t){function e(){return t.call(this)||this}n(e,t);var r=e.prototype;return r.on=function(t,n){return this.set(t,n),this},r.emit=function(t){var n=this.get(t);return!!n&&(n.apply(this,[].slice.call(arguments,1)),!0)},r.off=function(t){return this.delete(t),this},e}(/*#__PURE__*/i(Map)),v=/*#__PURE__*/function(t){function e(){var n;return(n=t.call(this)||this)._context={},n.version=void 0,n}n(e,t);var r=e.prototype;return r.setContext=function(t){this._context=t},r.getContext=function(){return this._context},e}(p);function y(){}export{v as AbstractPlugin,h as Core,p as EventEmitter,a as PluginEventEmitter,y as PluginFactory};
//# sourceMappingURL=index.modern.js.map
